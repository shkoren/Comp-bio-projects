---
title: "Relationship between ribosomal protein position and tau association"
author: "Shon Koren"
output:
  html_document: default
  pdf_document: default
indent: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

This is code demonstrating the relationship between human ribosomal protein (RP) structural position and association with the microtubule 
association protein tau. RP structurual position is based on an algorithm from RP interface index based on the number of amino acids (AA) interfacing with either rRNA or water (Natchiar et al., 2017, Shigeoka et al., 2019).
&nbsp;
<center>
$Interface Index = \displaystyle \frac{{\sum AA}_{rRNA}}{\sum(AA_{rRNA}+AA_{water})}$
</center>
&nbsp;

Internal RP proteins have more AA interfacing with rRNA than water resulting in a higher Interface Index. A common cutoff for RP structural position is 0.60 (Shigeoka et al., 2019).

```{r echo=FALSE, warning = FALSE, error = FALSE, message=FALSE}
#Initializing data and packages

library(BiocManager)
library(ggplot2)
library(dplyr)
library(ggstatsplot)
library(ComplexHeatmap)
setwd("D:/Dropbox (UFL)/Projects/tRNA/Codon Usage")
options(scipen = 999) #Turn off sci-notation

rpf = 'RP.full.csv'
rp.full = as.data.frame(read.csv(rpf, as.is=TRUE,header=TRUE,sep=',', check.names=FALSE))
colnames(rp.full)[1] = 'Symbol'
```

&nbsp;
Plotting for the relative frequency of RP interface indices reveals most RPs are external than internal, as expected.
&nbsp;

```{r echo=TRUE, warning = FALSE, error = FALSE, fig.align = 'center'}
ggplot(data = rp.full) + geom_histogram(aes(x = Interface, y = stat(count) / sum(count)), binwidth = .05) + xlab("Interface Index of RPs") + 
  ylab("Relative Frequency") + geom_vline(xintercept = 0.60, color = "red", linetype = "dashed", size = 2) + scale_x_continuous(limits = c(0, 1)) +
  scale_y_continuous(limits = c(0, .15)) + ggtitle("Human 80S Ribosome Protein Interface Index")
```

Next, load the data from Hsieh et al., 2019 which used label free quantification mass spectrometry (LFQ MS) to quantitatively assess proteins which associated with tau protein when immunoprecipitated from human postmortem brain tissue. In this study, tissue samples from the brain of patients with Alzheimer's disease (AD) were compared to control, non-demented patients (n = 4 per group). Before data loading, I filtered out interface index data from any RPs not detected by MS, limiting data to roughly 50 out of 80 potential RPs.

```{r echo=TRUE, warning = FALSE, error = FALSE, message=FALSE}
h19f = "Hsieh2019.csv"
h19 = as.data.frame(read.csv(h19f, as.is=TRUE,header=TRUE,sep=',', check.names=FALSE))
colnames(h19)[1] = 'Symbol'
h19[is.na(h19)] <- "Other"
h19$Tranlation[h19$Translation == "TRUE"] = "Translation"
```

```{r echo=FALSE, warning = FALSE, error = FALSE, message=FALSE}
ff = 'RP.interface.csv'
rp = as.data.frame(read.csv(ff, as.is=TRUE,header=TRUE,sep=',', check.names=FALSE))
colnames(rp)[1] = 'Symbol'
colnames(rp)[3] = 'AD.CT.FC'
```
As noted by the Hsieh et al., 2019 study among many others including from the Dr. Jose Abisambra lab, tau associates with many RPs. When we plot the data from Hsieh 2019, we see that translational or ribosomal proteins are highly enriched (log2 FC > 2) in AD over control samples.

```{r echo=TRUE, warning = FALSE, error = FALSE, fig.align = 'center'}
ggstatsplot::ggbetweenstats(
  data = h19,
  x = Translation,
  y = AD.CT.FC,
  notch = TRUE, # show notched box plot
  mean.ci = FALSE, # whether to display confidence interval for means
  k = 3, # number of decimal places for statistical results
  outlier.tagging = FALSE, # whether outliers need to be tagged
  xlab = "Ribosomal / Translational Related Protein", # label for the x-axis variable
  ylab = "Tau-IP Intensity AD-CT (log2 FC)", # label for the y-axis variable
  title = "Tau Association to Translational Proteins", # title text for the plot
  bf.message = FALSE,
  results.subtitle = FALSE,
) + geom_hline(yintercept = 0, color = "red", linetype = "dashed", size = 1)
```

There are two main possibilities dictating tau-RP association ignoring the association of tau to rRNA or other RNA:
1. Tau binds to extra-ribosomal proteins moreso than RPs present in stable ribosomes, or
2. Tau binds to RPs while present in ribosomes

If (1) is true, then tau would likely not favor any internal or external RP. If (2) is true, tau would likely favor associating with external RPs and prevent association with more internal RPs.

To assess whether there is a tendency for tau to bind to RPs based on their structural position, the two sample Kolmogorov-Smirnov (two-sample K-S) test can be used to determine whether two distributions occur independent of one another. Since a common cutoff for internal RPs is an Interface Index of 0.60, we can separate RPs based on that statistic. The two-sample K-S test can then be used to test whether the tau association of RPs in AD are independent of their structural position in the ribosome:
```{r echo=TRUE, warning = FALSE, error = FALSE, message=FALSE}
rp.filt.in = rp %>% filter(Interface > .6)
rp.filt.ex = rp %>% filter(Interface < .6)
ks.test(rp.filt.in$AD.CT.FC, rp.filt.ex$AD.CT.FC)
```

Since the p value of the two-sample K-S test > 0.05, ribosomal structural position does not correlate with whether RPs associate with tau more in AD. This is more easily viewed when plotted:

```{r echo=TRUE, warning = FALSE, error = FALSE, message=FALSE, fig.align = 'center'}
p1 = ggstatsplot::ggscatterstats(
  data = rp,
  x = Interface,
  y = AD.CT.FC,
  type = "np",
  xlab = "RP Interface Index\nHigher = Interior",
  ylab = "Tau-IP Intensity AD-CT (log2 FC)",
  label.var = Symbol,
  label.expression = pval > 1.3,
  results.subtitle = FALSE,
  marginal = FALSE,
  conf.level = 0,
  title = "Relationship between RP interface index and tau association",
  subtitle = "External RPs (Interface Index < 0.60) do not associate with tau greater than internal RPs:
  Two-sample Kolmogorov-Smirnov test: D = 0.38235, p-value = 0.2952",
  caption = "RP interface data from Natchiar et al., 2017, Shigeoka et al., 2019\nTau-IP data from Hsieh et al., 2019",
  bf.message = FALSE,
  centrality.parameter = "none"
)
p1 + geom_vline(xintercept = 0.60, color = "red", linetype = "dashed", size = 1)
```

The end result of this analysis reveals that tau associates with RPs regardless of their structural position. This suggests that tau might associate with RPs prior to their incorporation into the full ribosome, or based on some other factor.
